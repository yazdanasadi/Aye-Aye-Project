```         
---
title: "EDA Notebook R"
output: ayeaye_R_notebook
---
```

```{}
```

```{r}
library(Boruta)
library(xgboost)
library(randomForest)
library(glmnet)
library(caret)

# Function to perform feature selection and correlation analysis
feature_selection_and_correlation <- function(data, target_col, n_features = 5) {
  # Prepare data
  X <- data[, !colnames(data) %in% target_col]
  y <- data[[target_col]]
  
  # List to store results
  results <- list()
  
  # Boruta Algorithm
  boruta_result <- Boruta(X, y)
  boruta_features <- getSelectedAttributes(boruta_result, withTentative = FALSE)
  results$boruta <- boruta_features[1:min(n_features, length(boruta_features))]
  
  # XGBoost
  xgb_model <- xgboost(data = as.matrix(X), label = y, nrounds = 100, objective = "reg:squarederror")
  xgb_importance <- xgb.importance(model = xgb_model)
  results$xgboost <- xgb_importance$Feature[1:min(n_features, nrow(xgb_importance))]
  
  # Random Forest
  rf_model <- randomForest(X, y)
  rf_importance <- importance(rf_model)
  results$random_forest <- rownames(rf_importance)[order(rf_importance[, 1], decreasing = TRUE)][1:min(n_features, nrow(rf_importance))]
  
  # Logistic Regression (using Lasso for feature selection)
  if (is.factor(y)) {
    cv_model <- cv.glmnet(as.matrix(X), y, family = "binomial")
  } else {
    cv_model <- cv.glmnet(as.matrix(X), y)
  }
  coef_matrix <- coef(cv_model, s = "lambda.min")
  log_reg_features <- rownames(coef_matrix)[which(coef_matrix != 0)][-1]
  results$logistic_regression <- log_reg_features[1:min(n_features, length(log_reg_features))]
  
  # Elastic Net
  elastic_net_model <- cv.glmnet(as.matrix(X), y, alpha = 0.5)
  coef_matrix <- coef(elastic_net_model, s = "lambda.min")
  elastic_net_features <- rownames(coef_matrix)[which(coef_matrix != 0)][-1]
  results$elastic_net <- elastic_net_features[1:min(n_features, length(elastic_net_features))]
  
  # Calculate correlations
  correlations <- list()
  for (method in results) {
    pearson <- sapply(method, function(feature) cor(X[[feature]], y, method = "pearson"))
    spearman <- sapply(method, function(feature) cor(X[[feature]], y, method = "spearman"))
    kendall <- sapply(method, function(feature) cor(X[[feature]], y, method = "kendall"))
    correlations[[deparse(substitute(method))]] <- data.frame(
      Feature = method,
      Pearson = pearson,
      Spearman = spearman,
      Kendall = kendall
    )
  }
  
  list(selected_features = results, correlations = correlations)
}

```
